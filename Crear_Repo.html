<!DOCTYPE html>
<html class="dark" lang="es">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Crear Nuevo Repositorio</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#238636",
                        "background-dark": "#0d1117",
                        "card-dark": "#161b22",
                        "border-dark": "#30363d",
                        "text-primary-dark": "#c9d1d9",
                        "text-secondary-dark": "#8b949e",
                        "accent-blue": "#58a6ff",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                    },
                },
            },
        };
    </script>
    <style type="text/tailwindcss">
        .material-symbols-outlined {
            font-variation-settings: "FILL" 0, "wght" 300, "GRAD" 0, "opsz" 24;
            font-size: 20px;
        }
    </style>
</head>

<body class="bg-background-dark font-display text-text-primary-dark">
    <div class="flex min-h-screen">
        <main class="w-full flex-1 p-4 sm:p-6 lg:p-8">
            <!-- Se usará como contenedor del formulario para capturar el submit -->
            <form id="repoForm" class="max-w-4xl mx-auto">
                <header class="mb-8">
                    <h1 class="text-3xl font-bold">Crear un Nuevo Repositorio</h1>
                    <p class="text-text-secondary-dark mt-1">Un repositorio contiene todos los archivos de tu proyecto,
                        incluyendo el historial de revisiones.</p>
                </header>

                <!-- Contenedor de campos del formulario -->
                <div class="space-y-8">

                    <!-- Campo Nombre del Repositorio -->
                    <div>
                        <label class="block text-sm font-medium text-text-primary-dark" for="repo-name">Nombre del
                            Repositorio <span class="text-red-500">*</span></label>
                        <div class="mt-1 flex items-center">
                            <span
                                class="inline-flex items-center rounded-l-md border border-r-0 border-border-dark bg-card-dark px-3 text-text-secondary-dark">elenacoder
                                /</span>
                            <!-- ID Añadido: repoName -->
                            <input
                                class="block w-full min-w-0 flex-1 rounded-none rounded-r-md border-border-dark bg-background-dark text-text-primary-dark focus:border-accent-blue focus:ring-accent-blue sm:text-sm"
                                id="repoName" name="repo-name" placeholder="mi-increible-proyecto" type="text" />
                        </div>
                    </div>

                    <!-- Campo Visibilidad -->
                    <!-- <div>
                        <fieldset>
                            <legend class="text-sm font-medium text-text-primary-dark">Visibilidad <span
                                    class="text-red-500">*</span></legend>
                            <div class="mt-2 space-y-4">
                                <div
                                    class="flex items-start rounded-md border border-border-dark p-4 hover:border-accent-blue cursor-pointer">
                                    <input checked=""
                                        class="h-4 w-4 border-border-dark bg-background-dark text-accent-blue focus:ring-accent-blue"
                                        id="public" name="visibility" type="radio" value="public" />
                                    <div class="ml-3 text-sm">
                                        <label class="font-medium text-text-primary-dark flex items-center gap-2"
                                            for="public">
                                            <span class="material-symbols-outlined !text-base">public</span> Público
                                        </label>
                                        <p class="text-text-secondary-dark">Cualquiera en internet puede ver este
                                            repositorio. Tú eliges quién puede hacer commits.</p>
                                    </div>
                                </div>
                                <div
                                    class="flex items-start rounded-md border border-border-dark p-4 hover:border-accent-blue cursor-pointer">
                                    ID Añadido: private
                                    <input
                                        class="h-4 w-4 border-border-dark bg-background-dark text-accent-blue focus:ring-accent-blue"
                                        id="private" name="visibility" type="radio" value="private" />
                                    <div class="ml-3 text-sm">
                                        <label class="font-medium text-text-primary-dark flex items-center gap-2"
                                            for="private">
                                            <span class="material-symbols-outlined !text-base">lock</span> Privado
                                        </label>
                                        <p class="text-text-secondary-dark">Tú eliges quién puede ver y hacer commits en
                                            este repositorio.</p>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div> -->

                    <!-- Campo Contenido del README -->
                    <div>
                        <label class="block text-sm font-medium text-text-primary-dark mb-1"
                            for="readme-content">Contenido del README</label>
                        <p class="text-text-secondary-dark text-sm mb-2">Este es el archivo donde puedes describir tu
                            proyecto.</p>
                        <textarea
                            class="block w-full rounded-md border-border-dark bg-background-dark text-text-primary-dark focus:border-accent-blue focus:ring-accent-blue sm:text-sm"
                            id="readme-content" name="readme-content"
                            placeholder="Escribe aquí una descripción detallada de tu proyecto..." rows="6"></textarea>
                    </div>

                    <!-- Opciones Adicionales (Fork y Muro de Preguntas) -->
                    <!-- <div class="space-y-4">
                        <div class="relative flex items-start">
                            <div class="flex h-5 items-center">
                                //ID Añadido: enableFork//
                                <input
                                    class="h-4 w-4 rounded border-border-dark bg-background-dark text-accent-blue focus:ring-accent-blue"
                                    id="enableFork" name="enable-fork" type="checkbox" />
                            </div>
                            <div class="ml-3 text-sm">
                                <label class="font-medium text-text-primary-dark" for="enableFork">Habilitar
                                    Fork</label>
                                <p class="text-text-secondary-dark">Permite a otros usuarios copiar el repositorio.</p>
                            </div>
                        </div>
                        <div class="relative flex items-start">
                            <div class="flex h-5 items-center">
                                // ID Añadido: enableQnA //
                                <input
                                    class="h-4 w-4 rounded border-border-dark bg-background-dark text-accent-blue focus:ring-accent-blue"
                                    id="enableQnA" name="enable-wall" type="checkbox" />
                            </div>
                            <div class="ml-3 text-sm">
                                <label class="font-medium text-text-primary-dark" for="enableQnA">Habilitar Muro de
                                    Preguntas</label>
                                <p class="text-text-secondary-dark">Permite que los seguidores puedan resolver dudas
                                    sobre el proyecto.</p>
                            </div>
                        </div>
                    </div> -->

                    <!-- Otros campos -->
                    <!-- <div>
                        <label class="block text-sm font-medium text-text-primary-dark" for="collaborators">Agregar
                            Colaboradores</label>
                        <div class="mt-1 relative">
                            <span
                                class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary-dark">group_add</span>
                            <input
                                class="block w-full rounded-md border-border-dark bg-background-dark py-2 pl-10 pr-4 text-text-primary-dark focus:border-accent-blue focus:ring-accent-blue sm:text-sm"
                                id="collaborators" name="collaborators" placeholder="Buscar por nombre de usuario..."
                                type="text" />
                        </div>
                    </div> -->
                    <div>
                        <label class="block text-sm font-medium text-text-primary-dark">Seleccionar Portada del
                            Repositorio</label>
                        <div
                            class="mt-1 flex justify-center rounded-md border-2 border-dashed border-border-dark px-6 pt-5 pb-6">
                            <div class="space-y-1 text-center">
                                <span
                                    class="material-symbols-outlined !text-5xl text-text-secondary-dark">upload_file</span>
                                <div class="flex text-sm text-text-secondary-dark">
                                    <label
                                        class="relative cursor-pointer rounded-md font-medium text-accent-blue focus-within:outline-none focus-within:ring-2 focus-within:ring-accent-blue focus-within:ring-offset-2 focus-within:ring-offset-background-dark hover:text-blue-400"
                                        for="file-upload">
                                        <span>Sube un archivo</span>
                                        <input class="sr-only" id="file-upload" name="file-upload" type="file" />
                                    </label>
                                    <p class="pl-1">o arrástralo y suéltalo</p>
                                </div>
                                <p class="text-xs text-text-secondary-dark">Imágenes o videos hasta 10MB</p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-text-primary-dark" for="hashtags">Seleccionar
                            Hashtag</label>
                        <input
                            class="mt-1 block w-full rounded-md border-border-dark bg-background-dark text-text-primary-dark focus:border-accent-blue focus:ring-accent-blue sm:text-sm"
                            id="hashtags" name="hashtags" placeholder="Ej: #desarrolloweb #react #javascript"
                            type="text" />
                    </div>

                    <!-- Botones de Acción -->
                    <div class="border-t border-border-dark pt-6 flex justify-end gap-3">
                        <button id="cancelButton"
                            class="inline-flex justify-center rounded-md border border-border-dark bg-transparent py-2 px-6 text-sm font-medium text-text-primary-dark shadow-sm hover:bg-card-dark focus:outline-none focus:ring-2 focus:ring-border-dark focus:ring-offset-2 focus:ring-offset-background-dark"
                            type="button">
                            Cancelar
                        </button>
                        <button
                            class="inline-flex justify-center rounded-md border border-transparent bg-primary py-2 px-6 text-sm font-medium text-white shadow-sm hover:bg-[#2ea043] focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background-dark"
                            type="submit">
                            Crear Repositorio
                        </button>
                    </div>
                </div>
            </form>
        </main>
    </div>

    <!-- Modal Personalizado (Popup) - Oculto por defecto -->
    <div id="customModal" class="fixed inset-0 z-50 bg-black bg-opacity-70 hidden items-center justify-center">
        <div class="bg-card-dark p-6 rounded-lg w-full max-w-sm border border-border-dark shadow-xl">
            <h3 id="modalTitle" class="text-xl font-bold mb-3 text-white"></h3>
            <p id="modalMessage" class="text-text-secondary-dark mb-6"></p>
            <!-- Estructura de botones adaptada para mostrar 1 o 2 botones -->
            <div id="modalButtons" class="flex justify-end gap-3">
                <!-- Botón Secundario (e.g., "No, seguir editando" para el popup de Cancelar) -->
                <button id="modalSecondaryButton"
                    class="hidden inline-flex justify-center rounded-md border border-border-dark bg-transparent py-2 px-6 text-sm font-medium text-text-primary-dark shadow-sm hover:bg-card-dark focus:outline-none focus:ring-2 focus:ring-border-dark focus:ring-offset-2 focus:ring-offset-background-dark"
                    type="button">
                    No
                </button>

                <!-- Botón Primario (e.g., "Entendido" o "Sí, salir") -->
                <button id="modalPrimaryButton"
                    class="inline-flex justify-center rounded-md border border-transparent bg-primary py-2 px-6 text-sm font-medium text-white shadow-sm hover:bg-[#2ea043] focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background-dark">
                    Entendido
                </button>
            </div>
        </div>
    </div>

    <script>
        // Referencias a elementos del DOM
        const repoForm = document.getElementById('repoForm');
        const repoNameInput = document.getElementById('repoName');
        const visibilityPrivate = document.getElementById('private');
        const enableFork = document.getElementById('enableFork');
        const enableQnA = document.getElementById('enableQnA');
        const cancelButton = document.getElementById('cancelButton'); // Nuevo

        // Modal Elements
        const customModal = document.getElementById('customModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalPrimaryButton = document.getElementById('modalPrimaryButton');
        const modalSecondaryButton = document.getElementById('modalSecondaryButton');

        /**
         * Oculta el modal personalizado.
         */
        function closeModal() {
            customModal.classList.add('hidden');
            customModal.classList.remove('flex');
        }

        /**
         * Muestra el modal personalizado, ajustando botones y acciones según el tipo.
         * @param {string} title El título del mensaje.
         * @param {string} message El cuerpo del mensaje.
         * @param {string} type 'error' o 'confirm' para definir los botones y acciones.
         */
        function showModal(title, message, type = 'error') {
            modalTitle.textContent = title;
            modalMessage.textContent = message;

            // Clonar para resetear los listeners (es la forma más limpia en JS Vanilla)
            modalPrimaryButton.replaceWith(modalPrimaryButton.cloneNode(true));
            modalSecondaryButton.replaceWith(modalSecondaryButton.cloneNode(true));
            const newPrimaryButton = document.getElementById('modalPrimaryButton');
            const newSecondaryButton = document.getElementById('modalSecondaryButton');

            // Resetear estilos y visibilidad
            newSecondaryButton.classList.add('hidden');
            newPrimaryButton.classList.remove('bg-red-600', 'hover:bg-red-700', 'focus:ring-red-500');
            newPrimaryButton.classList.add('bg-primary', 'hover:bg-[#2ea043]', 'focus:ring-primary');


            if (type === 'confirm') {
                newPrimaryButton.textContent = "Sí, Salir";
                // Cambiar el color del botón primario a rojo para la acción destructiva
                newPrimaryButton.classList.remove('bg-primary', 'hover:bg-[#2ea043]', 'focus:ring-primary');
                newPrimaryButton.classList.add('bg-red-600', 'hover:bg-red-700', 'focus:ring-red-500');

                newSecondaryButton.textContent = "No, Seguir Editando";
                newSecondaryButton.classList.remove('hidden');

                // Acción para SI (Botón Primario): Redirigir a inicio.html
                newPrimaryButton.addEventListener('click', () => {
                    window.location.href = 'inicio.html';
                });

                // Acción para NO (Botón Secundario): Cerrar el modal
                newSecondaryButton.addEventListener('click', closeModal);

            } else { // Default: mensaje de error/éxito (un botón: Entendido)
                newPrimaryButton.textContent = "Entendido";

                // Acción para ENTENDIDO: Cerrar el modal
                newPrimaryButton.addEventListener('click', closeModal);
            }

            customModal.classList.remove('hidden');
            customModal.classList.add('flex');
        }

        // -------------------------------------------------------------
        // Lógica para el botón Cancelar
        cancelButton.addEventListener('click', () => {
            showModal(
                "¿Descartar Cambios?",
                "Si cancelas, todos los datos ingresados en el formulario se perderán. ¿Deseas volver a la página de inicio?",
                'confirm' // Activa el modo de confirmación
            );
        });
        // -------------------------------------------------------------

        /**
         * Función principal de validación del formulario (al hacer submit).
         */
        function validateForm(event) {
            // Previene el envío inmediato del formulario
            event.preventDefault();

            // 1. Validar Campos Requeridos (Nombre del Repositorio)
            if (repoNameInput.value.trim() === '') {
                showModal(
                    "Contenido incompleto",
                    "No puedes dejar el contenido del README en blanco.",
                    'error'
                );
                return;
            }

            // 2. Validar Conflicto de Opciones (Privado + Opciones Públicas)
            const isPrivate = visibilityPrivate.checked;
            const isForkEnabled = enableFork.checked;
            const isQnAEnabled = enableQnA.checked;

            if (isPrivate && (isForkEnabled || isQnAEnabled)) {
                showModal(
                    "Conflicto de Visibilidad",
                    "El repositorio es privado. Las opciones 'Habilitar Fork' y 'Habilitar Muro de Preguntas' solo están disponibles para repositorios públicos.",
                    'error'
                );
                enableFork.checked = false;
                enableQnA.checked = false;
                return;
            }

            // Si pasa todas las validaciones, simula éxito
            showModal("Éxito", "¡Repositorio validado y listo para ser creado!", 'error');

            // En una aplicación real, aquí se enviaría el formulario:
            // event.target.submit(); 
        }

        // Adjuntar la función de validación al evento 'submit' del formulario
        repoForm.addEventListener('submit', validateForm);

    </script>
</body>

</html>